---
title: "树莓派超频后性能与功耗的关系及提高每瓦性能的方法"
description: "研究树莓派CPU频率和功耗的关系，能效和电压的关系。"
date: 2016-08-10T15:42:40+08:00
categories:
  - 折腾
tags:
  - RaspberryPi
---

## 准备

- 树莓派2代B型。
- 测功率用淘宝37块买的电力检测仪。
- 电源用我买Nubia Z9 Max时配的，5V 1.5A。

## 测试方法

- 修改config.txt的arm_freq来超频。
- 把scaling_governor里的powersave改成performance来转换到最高频率。
- 使用aircrack-ng -S来测量满负载的功耗和性能。

## 数据表格

| 频率(MHz) | 待机功耗(W) | 满载功耗(W) | 性能(k/s) | 性能/频率 | 性能/功耗 | 
|-----|-----|-----|-----|-----|-----|
|600|1.75|2.31|339|0.56500|146.75|
|700|1.82|2.65|397|0.56714|149.81|
|800|1.83|2.81|455|0.56875|161.92|
|900|1.84|2.94|514|0.57111|174.83|
|1000|1.83|3.08|571|0.57100|185.39|
|1050|1.84|3.13|600|0.57143|191.69|
|1100|1.89|3.37|629|0.57182|186.65|

注：频率为1100MHz时，默认电压下，在高负载的情况下不能稳定运行。经测试，把over_voltage调为2可稳定运行。

## 结论

- 在governor为powersave的情况下，待机功耗为1.75W。
- 在governor为performance的情况下，待机功耗在不同频率下变化很小，约为1.84W。
- 随着频率的增加，每频率性能略微增加。
- 在over_voltage=0的情况下，随着频率的增加，每瓦性能增加。

**因此，如果想提升每瓦性能，我们可以在系统稳定的前提下，不加压，尽量超频。**  

另外，我们看到，即使加压超频，加压后的1100MHz的每瓦性能依然比不加压时的1000MHz高。提高低频率的每瓦性能的方法在后记中有讨论。  

## 后记

这些是在我完成*树莓派超频后性能与功耗的关系*后做的实验。  

### 意外发现

- 在超频后但CPU频率仍为600MHz的情况下，满载功耗和性能有略微上升。
- 在最高频率1000MHz、实际频率600MHZ的情况下，满载功耗为2.33W，性能为341k/s。待机功耗不变（原待机功耗2.31W，性能339k/s）。

**这说明超频后会极轻微地增加最低频率（即600MHz）时的满载功耗和性能**

### 系统稳定时的加压测试

```
arm_freq=1050
over_voltage=3
```

- governor为poversave时待机功耗无差别。
- governor为performance时待机功耗为1.91W，满载功耗为3.38W，性能为599k/s。
- 同频率下，加压，功耗上升，性能不变，同时发热增加，每瓦性能降低。

**因此，在系统稳定的情况下，不应该加压。**

### 提高每瓦性能的方法

这是一个意外发现，我把over_voltage改成负数，希望能降压。本以为会开不了机，但是结果却令人兴奋：over_voltage居然可以是负的！ 这说明我们能通过降低电压来提高每瓦性能。

下面是验证：

```
arm_freq=800
over_voltage=-3
```

governor为performance时待机功耗为1.78W，满载功耗为2.63W，性能为456k/s，性能/功耗=173.38（原待机功耗为1.83W，满载功耗为2.81W，性能为455k/s）。

这意味着，在保证系统稳定的前提下，我们可以减少电压，来提高每瓦性能。（事实上，我的笔记本CPU一直降低0.1V用。）

**所以，在你认为树莓派的性能已经够用的时候（达到你想要的频率后），你可以在保持系统稳定的前提下，尽量降低电压，来提高每瓦性能。**
